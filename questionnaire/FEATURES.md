# 问卷调查系统 - 完整功能说明

## 🎯 系统概述

本系统是一个功能完善的问卷调查系统，采用90年代复古网页风格设计，支持完整的问卷创建、发布、填写、统计分析流程。

## 🔐 权限系统

### 登录保护
- **所有页面均需登录访问**（除了填写问卷页面）
- 未登录用户会自动跳转到登录页
- 支持用户注册和登录
- 登录状态持久化（localStorage）

### 用户角色

#### 普通用户（USER）
- ✅ 创建和管理自己的问卷
- ✅ 查看问卷广场
- ✅ 填写公开问卷
- ✅ 查看自己问卷的统计数据
- ❌ 无法编辑他人的问卷
- ❌ 无法删除他人的问卷

#### 管理员（ADMIN）
- ✅ 查看所有用户创建的问卷
- ✅ 编辑任何用户的问卷
- ✅ 删除任何用户的问卷
- ✅ 管理所有问卷的统计数据
- ✅ 所有普通用户的权限

## 📱 页面功能详解

### 1. 登录页面 (`/login`)
**功能：**
- 用户登录
- 记住登录状态
- 测试账号提示

**测试账号：**
```
管理员：admin / password
普通用户：user1 / password
```

### 2. 注册页面 (`/register`)
**功能：**
- 新用户注册
- 用户名唯一性验证
- 密码长度验证（至少6位）
- 密码确认匹配检查
- 邮箱格式验证（可选）

**注册规则：**
- 用户名：3-20个字符
- 密码：至少6位
- 邮箱：可选填写

### 3. 首页 (`/`)
**功能：**
- 系统介绍
- 快速入口（创建问卷、问卷管理）
- 访问码输入（跳转填写页面）

**权限：**需要登录

### 4. 问卷广场 (`/questionnaire/square`)
**功能：**
- 展示所有已发布的**公开问卷**
- 显示问卷标题、说明、题目数量
- 显示参与人数统计
- 查看题目预览
- 快速填写问卷
- 复制访问码

**特点：**
- 只显示状态为"已发布"的问卷
- 只显示访问权限为"公开"的问卷
- 实时显示参与人数
- 弹窗预览题目内容

**权限：**需要登录

### 5. 问卷管理 (`/questionnaire/list`)
**功能：**
- 查看问卷列表
- 创建新问卷
- 编辑问卷
- 删除问卷
- 发布问卷
- 结束问卷
- 查看统计
- 分享问卷
- 预览问卷
- 复制访问码/链接

**权限说明：**
- **普通用户**：只能看到自己创建的问卷
- **管理员**：可以看到所有问卷
- **编辑权限**：只有创建者和管理员可编辑
- **删除权限**：只有创建者和管理员可删除

**问卷状态：**
- 草稿（DRAFT）：刚创建，未发布
- 已发布（PUBLISHED）：可以填写
- 已结束（ENDED）：无法继续填写

### 6. 创建/编辑问卷 (`/questionnaire/create`, `/questionnaire/edit/:id`)
**功能：**
- 设置问卷标题和说明
- 选择问卷类型（匿名/实名）
- 设置访问权限（公开/私有）
- 添加题目（支持4种题型）
- 设置必答题
- 题目排序

**支持的题型：**
1. **单选题**：添加多个选项，用户选择一个
2. **多选题**：添加多个选项，用户可选择多个
3. **填空题**：用户自由输入文本
4. **评分题**：1-5分评分

**权限检查：**
- 编辑时会检查是否为创建者或管理员
- 非创建者/管理员无法编辑他人问卷

### 7. 问卷分享详情 (`/questionnaire/detail/:id`)
**功能：**
- 显示大号访问码
- 显示完整访问链接
- 一键复制访问码
- 一键复制链接
- 预览问卷
- 生成二维码（演示版）
- 分享方式说明

**三种分享方式：**
1. 告知访问码
2. 发送访问链接
3. 扫描二维码（演示）

### 8. 填写问卷 (`/questionnaire/fill/:code`)
**功能：**
- 根据访问码加载问卷
- 展示问卷标题和说明
- 自动渲染不同类型题目
- 必填题验证
- 防重复提交（基于IP）
- 提交确认

**特点：**
- **无需登录**即可填写
- 自动检测问卷状态
- 草稿状态无法填写
- 已结束无法填写
- 同一IP只能提交一次

### 9. 数据统计 (`/questionnaire/stats/:id`)
**功能：**
- 总参与人数统计
- 数据概览卡片（完成率、题目数、参与人数、创建时间）
- 按题目统计分析
- 百分比图表（柱状图）
- 填空题答案列表
- 评分题统计（平均分、最高分、最低分、分布）
- 导出TXT格式报告
- **导出Excel/CSV格式**

**统计功能：**
- **单选/多选题**：
  - 每个选项的选择次数
  - 百分比统计
  - 可视化柱状图

- **填空题**：
  - 回答数量
  - 所有答案列表

- **评分题**：
  - 平均分
  - 最高分、最低分
  - 评分人数
  - 评分分布

**导出功能：**
- TXT文本格式
- CSV格式（可用Excel打开）

## 🎨 界面特色

### 复古90年代风格
- 米色背景（#f5f5dc）
- Times New Roman 字体
- 经典凸起/凹陷边框
- 蓝色超链接、紫色已访问链接
- 灰色按钮、彩色状态按钮
- 简洁的表格样式

### 响应式设计
- 支持PC端访问
- 基本的移动端适配

## 🔧 技术特性

### 前端技术
- Vue.js 3
- Vue Router 4（带路由守卫）
- Pinia（状态管理）
- Vite（构建工具）

### 后端技术
- Spring Boot 3.5.6
- MyBatis 3.0.3
- MySQL 8.0+

### 安全特性
- 路由守卫保护
- 登录状态验证
- 权限检查
- IP防重复提交
- CORS跨域配置

## 📊 数据流程

### 创建问卷流程
```
登录 → 创建问卷 → 添加题目 → 保存（草稿）
  → 发布 → 获取访问码 → 分享
```

### 填写问卷流程
```
获取访问码/链接 → 打开问卷 → 填写题目
  → 验证必填 → 提交 → IP检测 → 保存
```

### 查看统计流程
```
登录 → 问卷管理 → 选择问卷 → 统计
  → 查看图表 → 导出数据
```

## 🎯 使用场景

### 场景1：公司内部调查
1. 管理员创建满意度调查问卷
2. 设置为"匿名+公开"
3. 发布到问卷广场
4. 员工登录后在广场填写
5. 查看统计结果

### 场景2：活动报名
1. 创建活动报名问卷
2. 设置为"实名+公开"
3. 分享访问链接
4. 用户无需登录即可填写
5. 导出Excel统计报名信息

### 场景3：客户反馈
1. 创建客户反馈问卷
2. 设置为"匿名+公开"
3. 生成二维码海报
4. 客户扫码填写
5. 实时查看反馈统计

## 🔍 权限矩阵

| 功能 | 未登录 | 普通用户 | 管理员 |
|------|--------|----------|--------|
| 访问首页 | ❌ | ✅ | ✅ |
| 访问问卷广场 | ❌ | ✅ | ✅ |
| 填写问卷 | ✅ | ✅ | ✅ |
| 创建问卷 | ❌ | ✅ | ✅ |
| 查看自己的问卷 | ❌ | ✅ | ✅ |
| 查看所有问卷 | ❌ | ❌ | ✅ |
| 编辑自己的问卷 | ❌ | ✅ | ✅ |
| 编辑他人问卷 | ❌ | ❌ | ✅ |
| 删除自己的问卷 | ❌ | ✅ | ✅ |
| 删除他人问卷 | ❌ | ❌ | ✅ |
| 查看统计 | ❌ | ✅(仅自己) | ✅(所有) |

## 💾 数据库设计

### 核心表结构
1. **user** - 用户表
2. **questionnaire** - 问卷表
3. **question** - 题目表
4. **question_option** - 选项表
5. **response** - 答卷表
6. **answer** - 答案表

详见：`database/schema.sql`

## 📝 API 接口

### 认证接口
- `POST /api/auth/login` - 登录
- `POST /api/auth/register` - 注册
- `GET /api/auth/user/{id}` - 获取用户信息

### 问卷接口
- `POST /api/questionnaire` - 创建问卷
- `PUT /api/questionnaire/{id}` - 更新问卷
- `DELETE /api/questionnaire/{id}` - 删除问卷
- `GET /api/questionnaire/{id}` - 获取问卷详情
- `GET /api/questionnaire/code/{code}` - 通过访问码获取
- `GET /api/questionnaire/all` - 获取所有问卷
- `PUT /api/questionnaire/{id}/publish` - 发布问卷
- `PUT /api/questionnaire/{id}/end` - 结束问卷

### 答卷接口
- `POST /api/response` - 提交答卷
- `GET /api/response/questionnaire/{id}` - 获取答卷列表
- `GET /api/response/questionnaire/{id}/count` - 获取答卷数量

### 统计接口
- `GET /api/statistics/{id}` - 获取统计数据

## 🚀 快速开始

详见：`QUICKSTART.md`

## 📚 相关文档

- `README.md` - 项目总览
- `QUICKSTART.md` - 快速启动指南
- `AUTH_GUIDE.md` - 登录注册功能说明
- `SHARE_GUIDE.md` - 问卷分享功能说明
- `FEATURES.md` - 本文档（完整功能说明）

## 🎉 总结

本系统现已实现：
✅ 完整的用户认证系统
✅ 强大的权限管理
✅ 问卷广场功能
✅ 完善的数据统计
✅ 多种分享方式
✅ 复古的界面风格

适合作为学习项目或小型问卷调查系统使用！

